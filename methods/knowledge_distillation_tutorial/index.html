
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Semi-supervised ensemble learning with confidence weighting, optimized for imbalanced biomedical data">
      
      
        <meta name="author" content="CF-Ensemble Research Team">
      
      
        <link rel="canonical" href="https://pleiadian53.github.io/cf-ensemble/methods/knowledge_distillation_tutorial/">
      
      
        <link rel="prev" href="../hyperparameter_tuning/">
      
      
        <link rel="next" href="../../failure_modes/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Knowledge Distillation - CF-Ensemble</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#knowledge-distillation-learning-from-soft-targets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CF-Ensemble" class="md-header__button md-logo" aria-label="CF-Ensemble" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CF-Ensemble
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Knowledge Distillation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pleiadian53/cf-ensemble" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pleiadian53/cf-ensemble
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../QUICK_REFERENCE/" class="md-tabs__link">
        
  
  
    
  
  Quick Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../RESULTS_2026-01-24.md" class="md-tabs__link">
        
  
  
    
  
  Results Summary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../INSTALL/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Methods

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../failure_modes/" class="md-tabs__link">
          
  
  
  Failure Modes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../notebooks/" class="md-tabs__link">
          
  
  
  Notebooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples_README.md" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/" class="md-tabs__link">
          
  
  
  Setup Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CF-Ensemble" class="md-nav__button md-logo" aria-label="CF-Ensemble" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CF-Ensemble
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pleiadian53/cf-ensemble" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pleiadian53/cf-ensemble
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../QUICK_REFERENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../RESULTS_2026-01-24.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Results Summary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../QUICK_REFERENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../imbalanced_data_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Imbalanced Data Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Confidence Weighting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Confidence Weighting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../confidence_weighting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../confidence_weighting/when_to_use_confidence_weighting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    When to Use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../confidence_weighting/base_classifier_quality_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quality Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../confidence_weighting/theory_vs_empirics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Theory vs Empirics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../confidence_weighting/polarity_models_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Polarity Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Optimization
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cf_ensemble_optimization_objective_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objective Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../als_mathematical_derivation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS Derivation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../als_vs_pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS vs PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/TECHNIQUES_SUMMARY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Techniques Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/class_weighted_gradients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Class-Weighted Gradients
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization/focal_loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Focal Loss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hyperparameter_tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Distillation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Distillation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-fundamental-problem-compression-with-minimal-performance-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. The Fundamental Problem: Compression with Minimal Performance Loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. The Fundamental Problem: Compression with Minimal Performance Loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-we-need-smaller-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why We Need Smaller Models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-insight-of-knowledge-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Insight of Knowledge Distillation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-hard-labels-vs-soft-targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Hard Labels vs. Soft Targets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Hard Labels vs. Soft Targets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hard-labels-limited-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hard Labels: Limited Information
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-targets-rich-structural-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Soft Targets: Rich Structural Information
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-temperature-scaling-revealing-dark-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Temperature Scaling: Revealing Dark Knowledge
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Temperature Scaling: Revealing Dark Knowledge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-temperature-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Temperature Parameter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect-of-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Effect of Temperature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-higher-temperature-helps-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Higher Temperature Helps Learning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-knowledge-distillation-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. The Knowledge Distillation Loss Function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. The Knowledge Distillation Loss Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notation-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notation and Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-combined-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Combined Loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-t2-factor-why-its-essential-not-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. The \(T^2\) Factor: Why It's Essential, Not Optional
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. The \(T^2\) Factor: Why It&#39;s Essential, Not Optional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gradient-scaling-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gradient Scaling Problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Matters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-t2-correction" class="md-nav__link">
    <span class="md-ellipsis">
      
        The \(T^2\) Correction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-why-knowledge-distillation-works-four-key-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Why Knowledge Distillation Works: Four Key Mechanisms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Why Knowledge Distillation Works: Four Key Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-driven-label-smoothing" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Data-Driven Label Smoothing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-learning-decision-geometry" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Learning Decision Geometry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-efficient-capacity-utilization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Efficient Capacity Utilization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-implicit-regularization" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Implicit Regularization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-practical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Practical Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Practical Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#choosing-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing Temperature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-rho" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing \(\rho\)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#student-model-size" class="md-nav__link">
    <span class="md-ellipsis">
      
        Student Model Size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-beyond-simple-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Beyond Simple Distillation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Beyond Simple Distillation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Self-Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensemble-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensemble Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#online-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Online Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attention-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attention Transfer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-mathematical-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Mathematical Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Mathematical Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Formulation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-philosophical-takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Philosophical Takeaway
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Failure Modes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Failure Modes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../failure_modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../failure_modes/aggregator_weight_collapse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aggregator Weight Collapse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../failure_modes/transductive_vs_inductive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive vs Inductive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../failure_modes/als_approximation_vs_exact_optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS Approximation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../failure_modes/optimization_instability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization Instability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/01_collaborative_filtering/Demo-Part1-CF_with_ALS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaborative Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/02_loss_functions/Demo-Part2-The_Role_of_Loss_Function_in_CF_Ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/03_knn_ensemble/Demo-Part3-CF_Ensemble_with_kNNs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kNN Ensemble
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stacking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stacking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/04_stacking/Demo-Part4-CF_Stacker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CF Stacker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/04_stacking/demo-stacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stacking Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Probability Filtering
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Probability Filtering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/05_probability_filtering/Demo-Part5-CF_Ensemble_via_Probability_Filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Main Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/05_probability_filtering/Demo-Part5a-Alternative_Data_Representations_for_Probability_Filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alternative Representations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/05_probability_filtering/Demo-Part5b-Probability_Filtering_via_Custom_Loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Loss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples_README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples_confidence_weighting_README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Confidence Weighting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/mkdocs_mathjax_setup_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MkDocs + MathJax Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/mkdocs_quick_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-fundamental-problem-compression-with-minimal-performance-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. The Fundamental Problem: Compression with Minimal Performance Loss
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. The Fundamental Problem: Compression with Minimal Performance Loss">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-we-need-smaller-models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why We Need Smaller Models
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-insight-of-knowledge-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Insight of Knowledge Distillation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-hard-labels-vs-soft-targets" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Hard Labels vs. Soft Targets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Hard Labels vs. Soft Targets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hard-labels-limited-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hard Labels: Limited Information
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-targets-rich-structural-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        Soft Targets: Rich Structural Information
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-temperature-scaling-revealing-dark-knowledge" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Temperature Scaling: Revealing Dark Knowledge
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Temperature Scaling: Revealing Dark Knowledge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-temperature-parameter" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Temperature Parameter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#effect-of-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Effect of Temperature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-higher-temperature-helps-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Higher Temperature Helps Learning
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-the-knowledge-distillation-loss-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. The Knowledge Distillation Loss Function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. The Knowledge Distillation Loss Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notation-and-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notation and Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-combined-loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Combined Loss
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-the-t2-factor-why-its-essential-not-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. The \(T^2\) Factor: Why It's Essential, Not Optional
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. The \(T^2\) Factor: Why It&#39;s Essential, Not Optional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gradient-scaling-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Gradient Scaling Problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-this-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why This Matters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-t2-correction" class="md-nav__link">
    <span class="md-ellipsis">
      
        The \(T^2\) Correction
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-why-knowledge-distillation-works-four-key-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Why Knowledge Distillation Works: Four Key Mechanisms
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Why Knowledge Distillation Works: Four Key Mechanisms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-data-driven-label-smoothing" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Data-Driven Label Smoothing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-learning-decision-geometry" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Learning Decision Geometry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-efficient-capacity-utilization" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Efficient Capacity Utilization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-implicit-regularization" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Implicit Regularization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-practical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Practical Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Practical Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#choosing-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing Temperature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-rho" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing \(\rho\)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#student-model-size" class="md-nav__link">
    <span class="md-ellipsis">
      
        Student Model Size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-beyond-simple-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Beyond Simple Distillation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8. Beyond Simple Distillation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Self-Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensemble-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensemble Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#online-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Online Distillation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attention-transfer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attention Transfer
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-mathematical-summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. Mathematical Summary
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. Mathematical Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Formulation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-philosophical-takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. Philosophical Takeaway
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/pleiadian53/cf-ensemble/edit/main/docs/methods/knowledge_distillation_tutorial.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="knowledge-distillation-learning-from-soft-targets">Knowledge Distillation: Learning from Soft Targets<a class="headerlink" href="#knowledge-distillation-learning-from-soft-targets" title="Permanent link">&para;</a></h1>
<p><strong>A comprehensive guide to understanding how neural networks can transfer knowledge through soft predictions</strong></p>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Large neural networks learn powerful representations that enable excellent predictive performance. However, these models are often impractical to deploy due to memory and compute constraints. Knowledge distillation (KD) addresses this challenge by transferring task-specific knowledge from a large <strong>teacher model</strong> to a smaller <strong>student model</strong>. </p>
<p>The key insight of knowledge distillation is that we can extract more information from a trained model than just its predicted class labels. Instead of learning only from hard labels, the student also learns from the teacher's <strong>soft predictions</strong>probability distributions that encode rich information about class relationships and decision boundaries.</p>
<p>This tutorial walks through the mathematical foundations of knowledge distillation, explaining not just <em>what</em> we optimize, but <em>why</em> it works.</p>
<hr />
<h2 id="1-the-fundamental-problem-compression-with-minimal-performance-loss">1. The Fundamental Problem: Compression with Minimal Performance Loss<a class="headerlink" href="#1-the-fundamental-problem-compression-with-minimal-performance-loss" title="Permanent link">&para;</a></h2>
<h3 id="why-we-need-smaller-models">Why We Need Smaller Models<a class="headerlink" href="#why-we-need-smaller-models" title="Permanent link">&para;</a></h3>
<p>Large neural networks excel at their tasks because they develop rich internal representations. They don't simply output "this is class A"they implicitly encode:
- How confident they are about that classification
- How similar the input is to other classes
- The subtle relationships between classes</p>
<p>However, these models come with significant costs:
- <strong>Memory</strong>: Millions or billions of parameters
- <strong>Latency</strong>: Too slow for real-time or edge deployment
- <strong>Energy</strong>: High computational requirements</p>
<h3 id="the-core-insight-of-knowledge-distillation">The Core Insight of Knowledge Distillation<a class="headerlink" href="#the-core-insight-of-knowledge-distillation" title="Permanent link">&para;</a></h3>
<p>Rather than trying to compress the teacher's <em>weights</em> (parameters), knowledge distillation compresses the teacher's <em>judgment</em> (behavior). The student model learns to:</p>
<blockquote>
<p><strong>Mimic the teacher's decision-making process, not its internal structure</strong></p>
</blockquote>
<p>This is fundamentally different from model compression techniques like pruning or quantization, which directly manipulate the model architecture.</p>
<hr />
<h2 id="2-hard-labels-vs-soft-targets">2. Hard Labels vs. Soft Targets<a class="headerlink" href="#2-hard-labels-vs-soft-targets" title="Permanent link">&para;</a></h2>
<h3 id="hard-labels-limited-information">Hard Labels: Limited Information<a class="headerlink" href="#hard-labels-limited-information" title="Permanent link">&para;</a></h3>
<p>In standard supervised learning, we train classifiers using <strong>hard labels</strong>one-hot encoded vectors:</p>
<div class="arithmatex">\[y_{\text{hard}} = [0, 0, 1, 0, \ldots, 0] \in \{0,1\}^K\]</div>
<p>where <span class="arithmatex">\(K\)</span> is the number of classes. For a butterfly classifier, this might represent "class = monarch butterfly."</p>
<p><strong>What's missing</strong>: Hard labels provide <em>no information</em> about:
- Near misses (how close was it to being a viceroy butterfly?)
- Class relationships (which other species are similar?)
- Model uncertainty (was this a confident or borderline prediction?)</p>
<h3 id="soft-targets-rich-structural-information">Soft Targets: Rich Structural Information<a class="headerlink" href="#soft-targets-rich-structural-information" title="Permanent link">&para;</a></h3>
<p>A trained teacher model produces <strong>logits</strong> <span class="arithmatex">\(z_1, z_2, \ldots, z_K\)</span> (unnormalized scores), which are converted to probabilities via softmax:</p>
<div class="arithmatex">\[q_i = \frac{\exp(z_i)}{\sum_{j=1}^K \exp(z_j)}\]</div>
<p>These probabilities encode <em>structural information</em>:
$$q = [0.70, 0.25, 0.03, 0.02, \ldots] $$</p>
<p>This tells us: "70% monarch, 25% viceroy, 3% queen, 2% painted lady..."</p>
<p><strong>This structure is exactly what we want to transfer.</strong> The student learns not just the correct answer, but the teacher's understanding of class similarities and decision boundaries.</p>
<hr />
<h2 id="3-temperature-scaling-revealing-dark-knowledge">3. Temperature Scaling: Revealing Dark Knowledge<a class="headerlink" href="#3-temperature-scaling-revealing-dark-knowledge" title="Permanent link">&para;</a></h2>
<h3 id="the-temperature-parameter">The Temperature Parameter<a class="headerlink" href="#the-temperature-parameter" title="Permanent link">&para;</a></h3>
<p>The standard softmax can produce very sharp distributions (one class dominates, others near zero). To extract more information, we use <strong>temperature-scaled softmax</strong>:</p>
<div class="arithmatex">\[q_i(T) = \frac{\exp(z_i / T)}{\sum_{j=1}^K \exp(z_j / T)}\]</div>
<p>where <span class="arithmatex">\(T &gt; 0\)</span> is the <strong>temperature parameter</strong>.</p>
<h3 id="effect-of-temperature">Effect of Temperature<a class="headerlink" href="#effect-of-temperature" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><span class="arithmatex">\(T = 1\)</span></strong>: Standard softmax (default behavior)</li>
<li><strong><span class="arithmatex">\(T &lt; 1\)</span></strong>: Sharper distribution (more confident, approaching hard labels)</li>
<li><strong><span class="arithmatex">\(T &gt; 1\)</span></strong>: Softer distribution (reveals more class relationships)</li>
</ul>
<p><strong>Example</strong>: Consider logits <span class="arithmatex">\([10, 8, 1, 0.5]\)</span></p>
<table>
<thead>
<tr>
<th>Temperature</th>
<th>Class 1</th>
<th>Class 2</th>
<th>Class 3</th>
<th>Class 4</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(T = 1\)</span></td>
<td>0.843</td>
<td>0.155</td>
<td>0.001</td>
<td>0.001</td>
</tr>
<tr>
<td><span class="arithmatex">\(T = 2\)</span></td>
<td>0.665</td>
<td>0.325</td>
<td>0.006</td>
<td>0.004</td>
</tr>
<tr>
<td><span class="arithmatex">\(T = 5\)</span></td>
<td>0.474</td>
<td>0.461</td>
<td>0.037</td>
<td>0.028</td>
</tr>
</tbody>
</table>
<p>At <span class="arithmatex">\(T = 5\)</span>, we see that class 2 is nearly as likely as class 1, and even classes 3 and 4 receive non-negligible probability. This is the <strong>dark knowledge</strong>information invisible in hard labels or sharp distributions.</p>
<h3 id="why-higher-temperature-helps-learning">Why Higher Temperature Helps Learning<a class="headerlink" href="#why-higher-temperature-helps-learning" title="Permanent link">&para;</a></h3>
<p>With higher temperature:
1. <strong>Secondary classes become visible</strong>: Probabilities don't collapse to <span class="arithmatex">\(\approx 0\)</span>
2. <strong>Gradients carry more information</strong>: The student receives useful gradient signals about class relationships
3. <strong>Decision boundaries are smoother</strong>: The student learns a more robust, generalizable decision surface</p>
<hr />
<h2 id="4-the-knowledge-distillation-loss-function">4. The Knowledge Distillation Loss Function<a class="headerlink" href="#4-the-knowledge-distillation-loss-function" title="Permanent link">&para;</a></h2>
<h3 id="notation-and-setup">Notation and Setup<a class="headerlink" href="#notation-and-setup" title="Permanent link">&para;</a></h3>
<p>Let's define our objects precisely:</p>
<p><strong>Teacher model</strong> (large, pre-trained):
- Logits: <span class="arithmatex">\(z^{(t)} = [z_1^{(t)}, \ldots, z_K^{(t)}] \in \mathbb{R}^K\)</span>
- Soft targets: <span class="arithmatex">\(q_t^T = \text{softmax}_T(z^{(t)})\)</span></p>
<p><strong>Student model</strong> (small, being trained):
- Logits: <span class="arithmatex">\(z^{(s)} = [z_1^{(s)}, \ldots, z_K^{(s)}] \in \mathbb{R}^K\)</span>
- Soft predictions: <span class="arithmatex">\(q_s^T = \text{softmax}_T(z^{(s)})\)</span>
- Standard predictions: <span class="arithmatex">\(q_s = \text{softmax}_1(z^{(s)})\)</span></p>
<p><strong>Ground truth</strong>:
- Hard label: <span class="arithmatex">\(y_g \in \{0,1\}^K\)</span> (one-hot vector)</p>
<h3 id="the-combined-loss">The Combined Loss<a class="headerlink" href="#the-combined-loss" title="Permanent link">&para;</a></h3>
<p>The knowledge distillation loss combines two objectives:</p>
<div class="arithmatex">\[\boxed{\mathcal{L}_{\text{KD}} = \rho \cdot T^2 \cdot \text{KL}(q_t^T \| q_s^T) + (1-\rho) \cdot \text{CE}(y_g, q_s)}\]</div>
<p>Let's unpack every component:</p>
<h4 id="term-1-distillation-loss-imitation">Term 1: Distillation Loss (Imitation)<a class="headerlink" href="#term-1-distillation-loss-imitation" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[L_{\text{distill}} = T^2 \cdot \text{KL}(q_t^T \| q_s^T) = T^2 \cdot \sum_{i=1}^K q_{t,i}^T \log \frac{q_{t,i}^T}{q_{s,i}^T}\]</div>
<p>This is the <strong>Kullback-Leibler divergence</strong> that measures how well the student's soft predictions match the teacher's soft targets.</p>
<p><strong>Purpose</strong>: <em>"Imitate the teacher's behavior across all classes"</em></p>
<p><strong>Key properties</strong>:
- Uses temperature-scaled distributions for both teacher and student
- Asymmetric: forces <span class="arithmatex">\(q_s^T\)</span> to match <span class="arithmatex">\(q_t^T\)</span> (not vice versa)
- Minimizing KL means the student learns the teacher's uncertainty and class relationships</p>
<h4 id="term-2-supervised-loss-correctness">Term 2: Supervised Loss (Correctness)<a class="headerlink" href="#term-2-supervised-loss-correctness" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[L_{\text{supervised}} = \text{CE}(y_g, q_s) = -\sum_{i=1}^K y_{g,i} \log q_{s,i}\]</div>
<p>This is standard <strong>cross-entropy</strong> with hard labels (using <span class="arithmatex">\(T=1\)</span> for the student).</p>
<p>Since <span class="arithmatex">\(y_g\)</span> is one-hot, this reduces to:
$<span class="arithmatex">\(L_{\text{supervised}} = -\log q_{s,y}\)</span>$
where <span class="arithmatex">\(y\)</span> is the true class index.</p>
<p><strong>Purpose</strong>: <em>"Don't forget to predict the correct labels"</em></p>
<h4 id="trade-off-parameter-rho">Trade-off Parameter: <span class="arithmatex">\(\rho\)</span><a class="headerlink" href="#trade-off-parameter-rho" title="Permanent link">&para;</a></h4>
<div class="arithmatex">\[\rho \in [0, 1]\]</div>
<p>Controls the balance between imitation and correctness:
- <strong><span class="arithmatex">\(\rho = 1\)</span></strong>: Pure imitation (risky if teacher has biases)
- <strong><span class="arithmatex">\(\rho = 0\)</span></strong>: Standard supervised learning (no distillation)
- <strong><span class="arithmatex">\(\rho \in (0.3, 0.7)\)</span></strong>: Typical sweet spot in practice</p>
<hr />
<h2 id="5-the-t2-factor-why-its-essential-not-optional">5. The <span class="arithmatex">\(T^2\)</span> Factor: Why It's Essential, Not Optional<a class="headerlink" href="#5-the-t2-factor-why-its-essential-not-optional" title="Permanent link">&para;</a></h2>
<h3 id="the-gradient-scaling-problem">The Gradient Scaling Problem<a class="headerlink" href="#the-gradient-scaling-problem" title="Permanent link">&para;</a></h3>
<p>This is the most subtle but crucial aspect of knowledge distillation.</p>
<p>When we compute gradients of the softmax with respect to logits, we find:</p>
<div class="arithmatex">\[\frac{\partial q_i^T}{\partial z_j} \propto \frac{1}{T}\]</div>
<p>This means:
- <strong>Increasing <span class="arithmatex">\(T\)</span> shrinks gradients by factor <span class="arithmatex">\(1/T\)</span></strong>
- KL divergence involves <em>two</em> softmaxes (teacher and student)
- Backpropagation through both means <strong>gradient magnitude scales as <span class="arithmatex">\(1/T^2\)</span></strong></p>
<h3 id="why-this-matters">Why This Matters<a class="headerlink" href="#why-this-matters" title="Permanent link">&para;</a></h3>
<p>Without correction, increasing temperature would:
1. Make the distillation term numerically weak
2. Implicitly reduce the weight of teacher imitation
3. Make <span class="arithmatex">\(T\)</span> affect both <em>softness</em> and <em>importance</em></p>
<p>This would be problematic because we want <span class="arithmatex">\(T\)</span> to control <strong>what information is revealed</strong>, not <strong>how much we care about it</strong>.</p>
<h3 id="the-t2-correction">The <span class="arithmatex">\(T^2\)</span> Correction<a class="headerlink" href="#the-t2-correction" title="Permanent link">&para;</a></h3>
<p>Multiplying by <span class="arithmatex">\(T^2\)</span> <strong>neutralizes the gradient shrinkage</strong>:</p>
<div class="arithmatex">\[\nabla_{z^{(s)}} \left[ T^2 \cdot \text{KL}(q_t^T \| q_s^T) \right] \approx \text{constant magnitude across } T\]</div>
<p>This ensures:
- <span class="arithmatex">\(T\)</span> controls the <em>softness</em> of distributions
- <span class="arithmatex">\(\rho\)</span> remains the true trade-off parameter
- Gradients have consistent magnitude regardless of <span class="arithmatex">\(T\)</span></p>
<p><strong>Think of <span class="arithmatex">\(T^2\)</span> as a unit correction that makes the loss well-behaved.</strong></p>
<hr />
<h2 id="6-why-knowledge-distillation-works-four-key-mechanisms">6. Why Knowledge Distillation Works: Four Key Mechanisms<a class="headerlink" href="#6-why-knowledge-distillation-works-four-key-mechanisms" title="Permanent link">&para;</a></h2>
<h3 id="1-data-driven-label-smoothing">1. Data-Driven Label Smoothing<a class="headerlink" href="#1-data-driven-label-smoothing" title="Permanent link">&para;</a></h3>
<p>The teacher's soft targets act like <strong>label smoothing</strong>, but instead of uniform noise, the smoothing is:
- Adapted to each specific input
- Informed by the training data
- Aware of class relationships</p>
<p>This regularizes the student's loss landscape, preventing overconfident predictions.</p>
<h3 id="2-learning-decision-geometry">2. Learning Decision Geometry<a class="headerlink" href="#2-learning-decision-geometry" title="Permanent link">&para;</a></h3>
<p>Hard labels only tell the student <em>where to place decision boundaries</em>. Soft targets tell the student:
- How confident to be in different regions
- Which classes are similar (cluster together)
- Where the decision surface should be smooth vs. sharp</p>
<p>The student learns the <strong>geometry of the decision space</strong>, not just discrete labels.</p>
<h3 id="3-efficient-capacity-utilization">3. Efficient Capacity Utilization<a class="headerlink" href="#3-efficient-capacity-utilization" title="Permanent link">&para;</a></h3>
<p>A small model has limited capacity (parameters). By learning from the teacher's refined knowledge rather than raw data:
- The student doesn't waste capacity rediscovering trivial patterns
- Parameters are used to encode meaningful distinctions
- Convergence is often faster than training from scratch</p>
<h3 id="4-implicit-regularization">4. Implicit Regularization<a class="headerlink" href="#4-implicit-regularization" title="Permanent link">&para;</a></h3>
<p>Matching a trained teacher's behavior constrains the hypothesis space:
- Prevents the student from finding degenerate solutions
- Reduces overfitting on small training sets
- Acts as a strong inductive bias toward good generalizations</p>
<hr />
<h2 id="7-practical-considerations">7. Practical Considerations<a class="headerlink" href="#7-practical-considerations" title="Permanent link">&para;</a></h2>
<h3 id="choosing-temperature">Choosing Temperature<a class="headerlink" href="#choosing-temperature" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Start with <span class="arithmatex">\(T \in [2, 10]\)</span></strong> for most problems</li>
<li>Higher <span class="arithmatex">\(T\)</span> for fine-grained distinctions (e.g., 100+ classes)</li>
<li>Lower <span class="arithmatex">\(T\)</span> when classes are very distinct</li>
<li>Can be tuned as a hyperparameter via validation</li>
</ul>
<h3 id="choosing-rho">Choosing <span class="arithmatex">\(\rho\)</span><a class="headerlink" href="#choosing-rho" title="Permanent link">&para;</a></h3>
<ul>
<li><strong><span class="arithmatex">\(\rho = 0.5\)</span></strong> is a reasonable default</li>
<li>Increase <span class="arithmatex">\(\rho\)</span> when the teacher is highly reliable</li>
<li>Decrease <span class="arithmatex">\(\rho\)</span> when training data is limited or noisy</li>
<li>Some implementations use adaptive <span class="arithmatex">\(\rho\)</span> schedules</li>
</ul>
<h3 id="student-model-size">Student Model Size<a class="headerlink" href="#student-model-size" title="Permanent link">&para;</a></h3>
<ul>
<li>Typical compression ratios: <strong>5x to 100x</strong> parameter reduction</li>
<li>Performance retention: often <strong>90-95%</strong> of teacher accuracy</li>
<li>Diminishing returns below certain capacity thresholds</li>
</ul>
<hr />
<h2 id="8-beyond-simple-distillation">8. Beyond Simple Distillation<a class="headerlink" href="#8-beyond-simple-distillation" title="Permanent link">&para;</a></h2>
<p>Knowledge distillation has inspired many variants:</p>
<h3 id="self-distillation">Self-Distillation<a class="headerlink" href="#self-distillation" title="Permanent link">&para;</a></h3>
<p>The teacher is an earlier checkpoint of the same model, creating a form of temporal ensembling.</p>
<h3 id="ensemble-distillation">Ensemble Distillation<a class="headerlink" href="#ensemble-distillation" title="Permanent link">&para;</a></h3>
<p>Multiple teachers are distilled into a single student, combining their collective knowledge.</p>
<h3 id="online-distillation">Online Distillation<a class="headerlink" href="#online-distillation" title="Permanent link">&para;</a></h3>
<p>Teacher and student are trained simultaneously, with the teacher being a larger branch of the same network.</p>
<h3 id="attention-transfer">Attention Transfer<a class="headerlink" href="#attention-transfer" title="Permanent link">&para;</a></h3>
<p>Transfer intermediate attention maps, not just final predictions.</p>
<hr />
<h2 id="9-mathematical-summary">9. Mathematical Summary<a class="headerlink" href="#9-mathematical-summary" title="Permanent link">&para;</a></h2>
<h3 id="complete-formulation">Complete Formulation<a class="headerlink" href="#complete-formulation" title="Permanent link">&para;</a></h3>
<p>Given a dataset <span class="arithmatex">\(\{(x_i, y_i)\}_{i=1}^N\)</span>:</p>
<p><strong>Objective</strong>:
$<span class="arithmatex">\(\min_{\theta_s} \frac{1}{N} \sum_{i=1}^N \left[ \rho \cdot T^2 \cdot \text{KL}\left(q_t^T(x_i) \| q_s^T(x_i; \theta_s)\right) + (1-\rho) \cdot \text{CE}\left(y_i, q_s(x_i; \theta_s)\right) \right]\)</span>$</p>
<p>where:
- <span class="arithmatex">\(\theta_s\)</span> are student parameters
- <span class="arithmatex">\(q_t^T(x_i) = \text{softmax}_T(f_t(x_i))\)</span> (teacher, fixed)
- <span class="arithmatex">\(q_s^T(x_i; \theta_s) = \text{softmax}_T(f_s(x_i; \theta_s))\)</span> (student, soft)
- <span class="arithmatex">\(q_s(x_i; \theta_s) = \text{softmax}_1(f_s(x_i; \theta_s))\)</span> (student, hard)</p>
<p><strong>Gradient</strong> (w.r.t. student logits <span class="arithmatex">\(z^{(s)}\)</span>):
$<span class="arithmatex">\(\nabla_{z^{(s)}} \mathcal{L}_{\text{KD}} = \rho \cdot T \cdot (q_s^T - q_t^T) + (1-\rho) \cdot (q_s - y_g)\)</span>$</p>
<p>The first term encourages matching teacher probabilities; the second term encourages matching ground truth.</p>
<hr />
<h2 id="10-philosophical-takeaway">10. Philosophical Takeaway<a class="headerlink" href="#10-philosophical-takeaway" title="Permanent link">&para;</a></h2>
<p>Knowledge distillation reframes machine learning training as <strong>apprenticeship</strong> rather than <strong>memorization</strong>:</p>
<blockquote>
<p>The teacher doesn't hand over factsit demonstrates judgment.</p>
</blockquote>
<p>The student learns:
- Not just <em>what</em> to predict
- But <em>how</em> to think about predictions
- By observing the teacher's nuanced decision-making</p>
<p>This paradigm shiftlearning from behavior rather than labelshas become a cornerstone of modern model compression and efficient AI deployment.</p>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ol>
<li>Hinton, G., Vinyals, O., &amp; Dean, J. (2015). <em>Distilling the Knowledge in a Neural Network</em>. NIPS Deep Learning Workshop.</li>
<li>Gou, J., et al. (2021). <em>Knowledge Distillation: A Survey</em>. International Journal of Computer Vision.</li>
</ol>
<hr />
<p><strong>Next</strong>: See how these ideas connect to ensemble learning through collaborative filtering in <a href="../cf_ensemble_optimization_objective_tutorial/">CF-Ensemble Optimization Objective</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 CF-Ensemble Research Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/pleiadian53/cf-ensemble" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>