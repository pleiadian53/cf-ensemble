
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Semi-supervised ensemble learning with confidence weighting, optimized for imbalanced biomedical data">
      
      
        <meta name="author" content="CF-Ensemble Research Team">
      
      
        <link rel="canonical" href="https://pleiadian53.github.io/cf-ensemble/methods/confidence_weighting/when_to_use_confidence_weighting/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../base_classifier_quality_analysis/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>When to Use - CF-Ensemble</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#when-to-use-confidence-weighting-a-practitioners-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CF-Ensemble" class="md-header__button md-logo" aria-label="CF-Ensemble" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CF-Ensemble
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              When to Use
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pleiadian53/cf-ensemble" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pleiadian53/cf-ensemble
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../QUICK_REFERENCE/" class="md-tabs__link">
        
  
  
    
  
  Quick Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../RESULTS_2026-01-24.md" class="md-tabs__link">
        
  
  
    
  
  Results Summary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../INSTALL/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  Methods

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../failure_modes/" class="md-tabs__link">
          
  
  
  Failure Modes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../notebooks/" class="md-tabs__link">
          
  
  
  Notebooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples_README.md" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../guides/" class="md-tabs__link">
          
  
  
  Setup Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CF-Ensemble" class="md-nav__button md-logo" aria-label="CF-Ensemble" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CF-Ensemble
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pleiadian53/cf-ensemble" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pleiadian53/cf-ensemble
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../QUICK_REFERENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RESULTS_2026-01-24.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Results Summary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../INSTALL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../QUICK_REFERENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../imbalanced_data_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Imbalanced Data Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Confidence Weighting
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Confidence Weighting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    When to Use
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    When to Use
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#notation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classifier-quality-q" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classifier Quality (q)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average-ensemble-quality" class="md-nav__link">
    <span class="md-ellipsis">
      
        Average Ensemble Quality
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metric-selection-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric Selection Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diversity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diversity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensemble-size-m" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensemble Size (m)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-example-computing-all-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Example: Computing All Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-decision-tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Decision Tree
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental-evidence-2026-01-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experimental Evidence (2026-01-24)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental Evidence (2026-01-24)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#imbalanced-data-experiments-primary-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Imbalanced Data Experiments ⭐ PRIMARY RESULTS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-discovery-the-5-sweet-spot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Discovery: The 5% Sweet Spot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results-by-imbalance-level" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results by Imbalance Level
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#earlier-experiments-balancedmild-imbalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Earlier Experiments (Balanced/Mild Imbalance)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ensemble-size-effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Ensemble Size Effect
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Ensemble Size Effect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-size-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Size Matters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-ensemble-size-doesnt-save-you" class="md-nav__link">
    <span class="md-ellipsis">
      
        When Ensemble Size Doesn't Save You
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strategy-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strategy Recommendations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strategy Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-large-ensembles-m-12" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Large Ensembles (m ≥ 12)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-medium-ensembles-5-m-12" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Medium Ensembles (5 ≤ m &lt; 12)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-small-ensembles-m-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Small Ensembles (m &lt; 5)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-imbalance-impact-validated-2026-01-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class Imbalance Impact (Validated 2026-01-24)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class Imbalance Impact (Validated 2026-01-24)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-goldilocks-principle-of-imbalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Goldilocks Principle of Imbalance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations-by-imbalance-level" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendations by Imbalance Level
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-thresholds-validated" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quality Thresholds (Validated)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quality Thresholds (Validated)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#below-055-roc-auc-fix-classifiers-first" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ Below 0.55 ROC-AUC: Fix Classifiers First
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#055-075-roc-auc-optimal-range" class="md-nav__link">
    <span class="md-ellipsis">
      
        ✅ 0.55-0.75 ROC-AUC: Optimal Range ⭐
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#075-085-roc-auc-diminishing-returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⚠️ 0.75-0.85 ROC-AUC: Diminishing Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#above-085-roc-auc-ceiling-effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⚠️ Above 0.85 ROC-AUC: Ceiling Effect
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-misconceptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Misconceptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Misconceptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-classifiers-always-use-confidence-weighting" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "More classifiers → Always use confidence weighting"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confidence-weighting-always-helps" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "Confidence weighting always helps"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#low-quality-confidence-weighting-can-save-it" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "Low quality → Confidence weighting can save it"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-ensembles-simple-averaging-powerful" class="md-nav__link">
    <span class="md-ellipsis">
      
        ✅ "Large ensembles + simple averaging = powerful"
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diagnostic Checklist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommended-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommended Reading
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base_classifier_quality_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quality Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory_vs_empirics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Theory vs Empirics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polarity_models_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Polarity Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Optimization
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cf_ensemble_optimization_objective_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objective Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../als_mathematical_derivation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS Derivation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../als_vs_pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS vs PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/TECHNIQUES_SUMMARY/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Techniques Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/class_weighted_gradients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Class-Weighted Gradients
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../optimization/focal_loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Focal Loss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hyperparameter_tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../knowledge_distillation_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Distillation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Failure Modes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Failure Modes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../failure_modes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../failure_modes/aggregator_weight_collapse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aggregator Weight Collapse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../failure_modes/transductive_vs_inductive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transductive vs Inductive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../failure_modes/als_approximation_vs_exact_optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ALS Approximation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../failure_modes/optimization_instability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optimization Instability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/01_collaborative_filtering/Demo-Part1-CF_with_ALS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaborative Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/02_loss_functions/Demo-Part2-The_Role_of_Loss_Function_in_CF_Ensemble/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/03_knn_ensemble/Demo-Part3-CF_Ensemble_with_kNNs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    kNN Ensemble
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stacking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stacking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/04_stacking/Demo-Part4-CF_Stacker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CF Stacker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/04_stacking/demo-stacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stacking Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Probability Filtering
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Probability Filtering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/05_probability_filtering/Demo-Part5-CF_Ensemble_via_Probability_Filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Main Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/05_probability_filtering/Demo-Part5a-Alternative_Data_Representations_for_Probability_Filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alternative Representations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notebooks/05_probability_filtering/Demo-Part5b-Probability_Filtering_via_Custom_Loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Loss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples_README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples_confidence_weighting_README.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Confidence Weighting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/mkdocs_mathjax_setup_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MkDocs + MathJax Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/mkdocs_quick_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#notation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classifier-quality-q" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classifier Quality (q)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#average-ensemble-quality" class="md-nav__link">
    <span class="md-ellipsis">
      
        Average Ensemble Quality
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metric-selection-guide" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric Selection Guide
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diversity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diversity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensemble-size-m" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensemble Size (m)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-example-computing-all-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Example: Computing All Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-decision-tree" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Decision Tree
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experimental-evidence-2026-01-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experimental Evidence (2026-01-24)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Experimental Evidence (2026-01-24)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#imbalanced-data-experiments-primary-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Imbalanced Data Experiments ⭐ PRIMARY RESULTS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-discovery-the-5-sweet-spot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Discovery: The 5% Sweet Spot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results-by-imbalance-level" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results by Imbalance Level
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#earlier-experiments-balancedmild-imbalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Earlier Experiments (Balanced/Mild Imbalance)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-ensemble-size-effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Ensemble Size Effect
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Ensemble Size Effect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-size-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Size Matters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-ensemble-size-doesnt-save-you" class="md-nav__link">
    <span class="md-ellipsis">
      
        When Ensemble Size Doesn't Save You
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strategy-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strategy Recommendations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Strategy Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-large-ensembles-m-12" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Large Ensembles (m ≥ 12)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-medium-ensembles-5-m-12" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Medium Ensembles (5 ≤ m &lt; 12)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#for-small-ensembles-m-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Small Ensembles (m &lt; 5)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-imbalance-impact-validated-2026-01-24" class="md-nav__link">
    <span class="md-ellipsis">
      
        Class Imbalance Impact (Validated 2026-01-24)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class Imbalance Impact (Validated 2026-01-24)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-goldilocks-principle-of-imbalance" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Goldilocks Principle of Imbalance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommendations-by-imbalance-level" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendations by Imbalance Level
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quality-thresholds-validated" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quality Thresholds (Validated)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quality Thresholds (Validated)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#below-055-roc-auc-fix-classifiers-first" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ Below 0.55 ROC-AUC: Fix Classifiers First
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#055-075-roc-auc-optimal-range" class="md-nav__link">
    <span class="md-ellipsis">
      
        ✅ 0.55-0.75 ROC-AUC: Optimal Range ⭐
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#075-085-roc-auc-diminishing-returns" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⚠️ 0.75-0.85 ROC-AUC: Diminishing Returns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#above-085-roc-auc-ceiling-effect" class="md-nav__link">
    <span class="md-ellipsis">
      
        ⚠️ Above 0.85 ROC-AUC: Ceiling Effect
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-misconceptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Misconceptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Misconceptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-classifiers-always-use-confidence-weighting" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "More classifiers → Always use confidence weighting"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confidence-weighting-always-helps" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "Confidence weighting always helps"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#low-quality-confidence-weighting-can-save-it" class="md-nav__link">
    <span class="md-ellipsis">
      
        ❌ "Low quality → Confidence weighting can save it"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#large-ensembles-simple-averaging-powerful" class="md-nav__link">
    <span class="md-ellipsis">
      
        ✅ "Large ensembles + simple averaging = powerful"
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diagnostic Checklist
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommended-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommended Reading
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/pleiadian53/cf-ensemble/edit/main/docs/methods/confidence_weighting/when_to_use_confidence_weighting.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="when-to-use-confidence-weighting-a-practitioners-guide">When to Use Confidence Weighting: A Practitioner's Guide<a class="headerlink" href="#when-to-use-confidence-weighting-a-practitioners-guide" title="Permanent link">&para;</a></h1>
<p><strong>TL;DR</strong>: Confidence weighting helps most with <strong>few classifiers (m &lt; 8)</strong> in the <strong>quality sweet spot (55-75% ROC-AUC)</strong> with <strong>high diversity</strong>. With many classifiers (m &gt; 12), simple averaging is surprisingly effective!</p>
<hr />
<h2 id="notation">Notation<a class="headerlink" href="#notation" title="Permanent link">&para;</a></h2>
<p>Throughout this document, we use the following notation:</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Meaning</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>m</strong></td>
<td>Number of base classifiers</td>
<td>m = 15 (you have 15 models)</td>
</tr>
<tr>
<td><strong>n</strong></td>
<td>Number of instances (data points)</td>
<td>n = 1000 (1000 patients, genes, etc.)</td>
</tr>
<tr>
<td><strong>u</strong></td>
<td>Classifier index</td>
<td 0_="0," 1_="1," class="..," m-1="m-1">u ∈</td>
</tr>
<tr>
<td><strong>i</strong></td>
<td>Instance index</td>
<td 0_="0," 1_="1," class="..," n-1="n-1">i ∈</td>
</tr>
<tr>
<td><strong>R</strong></td>
<td>Probability matrix, shape (m, n)</td>
<td>R[u, i] = probability that classifier u assigns to instance i</td>
</tr>
<tr>
<td><strong>labels</strong></td>
<td>True labels, shape (n,)</td>
<td>labels[i] = 1 (positive) or 0 (negative)</td>
</tr>
<tr>
<td><strong>labeled_mask</strong></td>
<td>Boolean mask for labeled data</td>
<td>labeled_mask[i] = True if instance i is labeled</td>
</tr>
<tr>
<td><strong>y_true</strong></td>
<td>True labels (labeled instances only)</td>
<td>y_true = labels[labeled_mask]</td>
</tr>
</tbody>
</table>
<p><strong>Example setup:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># You have:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">m</span> <span class="o">=</span> <span class="mi">15</span>                           <span class="c1"># 15 classifiers (e.g., Random Forest, SVM, Neural Net, ...)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>                         <span class="c1"># 1000 instances (e.g., patients, genomic sequences, ...)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>   <span class="c1"># Probability matrix: R[u, i] = classifier u&#39;s prediction for instance i</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,))</span> <span class="c1"># Ground truth: labels[i] = 1 or 0 (may contain NaN for unlabeled)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># To evaluate classifier u on labeled data:</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Loop over classifiers u=0, 1, 2, ..., 14</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">quality_u</span> <span class="o">=</span> <span class="n">compute_metric</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span></code></pre></div></p>
<hr />
<h2 id="key-definitions">Key Definitions<a class="headerlink" href="#key-definitions" title="Permanent link">&para;</a></h2>
<h3 id="classifier-quality-q">Classifier Quality (q)<a class="headerlink" href="#classifier-quality-q" title="Permanent link">&para;</a></h3>
<p><strong>Primary Metric: Depends on Your Data</strong></p>
<p><strong>For Imbalanced Data (Recommended)</strong>: <strong>PR-AUC (Precision-Recall AUC)</strong> or <strong>F1-Score</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">average_precision_score</span><span class="p">,</span> <span class="n">precision_recall_curve</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">f1_score</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># For a single classifier u (e.g., u=0 for the first classifier)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Classifier index</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># PR-AUC (Precision-Recall AUC) - RECOMMENDED for imbalanced data</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># R[u, labeled_mask] = predictions from classifier u on labeled instances</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># y_true[labeled_mask] = ground truth labels for labeled instances</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">quality_prauc</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># Or manually compute PR-AUC</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="n">precision</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">precision_recall_curve</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">quality_prauc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c1"># F1-Score (requires threshold, here we use 0.5)</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">quality_f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>For Balanced Data</strong>: <strong>ROC-AUC</strong> is acceptable</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># ROC-AUC - Use only if classes are roughly balanced (e.g., 40/60)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">u</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Classifier index</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">quality_roc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span></code></pre></div>
<p><strong>Interpretation</strong> (for PR-AUC or ROC-AUC):
- <strong>1.0</strong> = Perfect classifier (no errors)
- <strong>0.9-0.95</strong> = Excellent (our "ceiling" range)
- <strong>0.75-0.85</strong> = Good (diminishing returns zone)
- <strong>0.55-0.75</strong> = Moderate (sweet spot for confidence weighting)
- <strong>0.50</strong> = Random baseline (varies by metric)
- <strong>&lt; 0.50</strong> = Below random (something is wrong)</p>
<p><strong>Why PR-AUC for Imbalanced Data?</strong> ✅ <strong>RECOMMENDED</strong>
1. ✅ <strong>Focuses on minority class</strong> (what you actually care about - e.g., splice sites)
2. ✅ <strong>Ignores TNs</strong> (abundant negatives don't inflate score)
3. ✅ <strong>Threshold-independent</strong> (evaluates ranking quality)
4. ✅ <strong>Sensitive to performance on positives</strong> (critical for biomedical data)</p>
<p><strong>Why NOT ROC-AUC for severe imbalance?</strong> ⚠️
1. ❌ <strong>Misleading with few positives</strong> - High TN count inflates score
2. ❌ <strong>Equal weight to FPR and TPR</strong> - But we care more about TPR!
3. ❌ <strong>Can look good while missing most positives</strong> - Dangerous in critical applications (e.g., disease detection, splice site prediction)</p>
<p><strong>When ROC-AUC is okay:</strong>
- Balanced datasets (e.g., 40/60 split)
- When FPR and TPR are equally important
- Comparing with literature that uses ROC-AUC</p>
<h3 id="average-ensemble-quality">Average Ensemble Quality<a class="headerlink" href="#average-ensemble-quality" title="Permanent link">&para;</a></h3>
<p>The <strong>average quality</strong> across all m classifiers:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Compute quality for each of the m classifiers</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">qualities</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># u = 0, 1, 2, ..., m-1 (each classifier)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="c1"># Evaluate classifier u on labeled data</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">],</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">qualities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># Average quality across all classifiers</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">avg_quality</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">qualities</span><span class="p">)</span>  <span class="c1"># This is what we mean by &quot;quality q&quot;</span>
</span></code></pre></div>
<p><strong>Example</strong>:
- m = 15 classifiers
- Individual qualities: [0.65, 0.70, 0.58, 0.72, 0.68, ...]
- Average quality q = 0.68 → We say "Quality 0.68" in this document</p>
<h3 id="metric-selection-guide">Metric Selection Guide<a class="headerlink" href="#metric-selection-guide" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Use Case</th>
<th>Formula</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PR-AUC</strong> ⭐</td>
<td><strong>Imbalanced data</strong> (biomedical, rare events)</td>
<td><code>average_precision_score(y_true, y_pred_proba)</code></td>
<td><strong>RECOMMENDED default</strong></td>
</tr>
<tr>
<td><strong>F1-Score</strong></td>
<td>Imbalanced data, need single threshold</td>
<td><code>2 * (precision * recall) / (precision + recall)</code></td>
<td>Good for operational metrics</td>
</tr>
<tr>
<td><strong>ROC-AUC</strong></td>
<td>Balanced data, literature comparison</td>
<td><code>roc_auc_score(y_true, y_pred_proba)</code></td>
<td>⚠️ Misleading if severe imbalance</td>
</tr>
<tr>
<td><strong>Accuracy</strong></td>
<td>Balanced data, all errors equal cost</td>
<td><code>mean(y_true == y_pred)</code></td>
<td>❌ Avoid for imbalanced data</td>
</tr>
<tr>
<td><strong>AP (Avg Precision)</strong></td>
<td>Same as PR-AUC</td>
<td><code>average_precision_score(y_true, y_pred_proba)</code></td>
<td>AP ≈ PR-AUC in practice</td>
</tr>
</tbody>
</table>
<p><strong>⚠️ Important</strong>: 
- <strong>For imbalanced data (most biomedical applications)</strong>: Use <strong>PR-AUC</strong> or <strong>F1-Score</strong>
- <strong>For balanced data</strong>: ROC-AUC is acceptable
- <strong>Throughout this document</strong>: When we say <strong>"quality 0.70"</strong>, we mean <strong>quality metric ≈ 0.70</strong> (adjust interpretation based on your chosen metric)</p>
<h3 id="diversity">Diversity<a class="headerlink" href="#diversity" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong>: Standard deviation of classifier qualities.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># qualities = [quality_0, quality_1, ..., quality_{m-1}]</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1"># Example: qualities = [0.65, 0.70, 0.58, 0.72, 0.68] for m=5 classifiers</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">diversity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">qualities</span><span class="p">)</span>  <span class="c1"># Higher = more diverse</span>
</span></code></pre></div>
<p><strong>Interpretation</strong>:
- <strong>&gt; 0.10</strong> = High diversity (classifiers have very different strengths/weaknesses)
  - Example: qualities = [0.50, 0.70, 0.55, 0.80, 0.60] → std = 0.11
- <strong>0.05-0.10</strong> = Medium diversity
  - Example: qualities = [0.65, 0.70, 0.68, 0.72, 0.66] → std = 0.03
- <strong>&lt; 0.05</strong> = Low diversity (all classifiers perform similarly)
  - Example: qualities = [0.68, 0.69, 0.67, 0.68, 0.69] → std = 0.008</p>
<p><strong>Why it matters</strong>: High diversity means classifiers make different errors on different instances, which confidence weighting can leverage to improve ensemble performance.</p>
<h3 id="ensemble-size-m">Ensemble Size (m)<a class="headerlink" href="#ensemble-size-m" title="Permanent link">&para;</a></h3>
<p><strong>Definition</strong>: Number of base classifiers in your ensemble.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># m = number of classifiers, n = number of instances</span>
</span></code></pre></div>
<p><strong>Critical thresholds</strong>:
- <strong>m &lt; 5</strong> = Very small (each classifier critical)
- <strong>5 ≤ m &lt; 12</strong> = Medium (sweet spot for confidence weighting)
- <strong>m ≥ 12</strong> = Large (simple averaging very effective)
- <strong>m ≥ 15</strong> = Very large (minimal gains from weighting)</p>
<h3 id="complete-example-computing-all-metrics">Complete Example: Computing All Metrics<a class="headerlink" href="#complete-example-computing-all-metrics" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">average_precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">precision_recall_curve</span><span class="p">,</span> <span class="n">auc</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">evaluate_ensemble_config</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">labeled_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="sd">    Evaluate ensemble configuration and quality.</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="sd">    Parameters</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="sd">    ----------</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="sd">    R : np.ndarray, shape (m, n)</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="sd">        Probability matrix (classifiers × instances)</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="sd">    labels : np.ndarray, shape (n,)</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="sd">        True labels (may contain NaN for unlabeled)</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="sd">    labeled_idx : np.ndarray, optional</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="sd">        Boolean mask or indices for labeled instances</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="sd">    metric : str, default=&#39;auto&#39;</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="sd">        Quality metric: &#39;prauc&#39; (recommended for imbalanced), &#39;roc_auc&#39;, &#39;f1&#39;, or &#39;auto&#39;</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="sd">        &#39;auto&#39; selects prauc if imbalance detected, otherwise roc_auc</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="sd">    Returns</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="sd">    -------</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="sd">    dict with keys: m, n, avg_quality, diversity, qualities, baseline_score, metric_used</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>    <span class="c1"># Create labeled mask</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>    <span class="k">if</span> <span class="n">labeled_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>        <span class="n">labeled_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>    <span class="k">elif</span> <span class="n">labeled_idx</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>        <span class="n">labeled_mask</span> <span class="o">=</span> <span class="n">labeled_idx</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>        <span class="n">labeled_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>        <span class="n">labeled_mask</span><span class="p">[</span><span class="n">labeled_idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">labeled_mask</span><span class="p">]</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>    <span class="c1"># Auto-detect imbalance</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>    <span class="n">pos_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>    <span class="n">is_imbalanced</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_rate</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pos_rate</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>    <span class="c1"># Select metric</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>    <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>        <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;prauc&#39;</span> <span class="k">if</span> <span class="n">is_imbalanced</span> <span class="k">else</span> <span class="s1">&#39;roc_auc&#39;</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚙️  Auto-selected metric: </span><span class="si">{</span><span class="n">metric</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> (positive rate: </span><span class="si">{</span><span class="n">pos_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>    <span class="c1"># Compute quality for each of the m classifiers</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>    <span class="n">qualities</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>  <span class="c1"># Loop over classifiers: u = 0, 1, ..., m-1</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>            <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;prauc&#39;</span><span class="p">:</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>                <span class="c1"># Evaluate classifier u using PR-AUC</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>                <span class="n">score</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>            <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>                <span class="c1"># Evaluate classifier u using ROC-AUC</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>                <span class="n">score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">])</span>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>            <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;f1&#39;</span><span class="p">:</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>                <span class="c1"># Evaluate classifier u using F1-Score (requires hard predictions)</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">labeled_mask</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>                <span class="n">score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>            <span class="n">qualities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>            <span class="c1"># Handle edge cases (e.g., only one class present)</span>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>            <span class="n">qualities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span> <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;prauc&#39;</span><span class="p">,</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a>    <span class="n">qualities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">qualities</span><span class="p">)</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>    <span class="c1"># Baseline ensemble (simple averaging across all m classifiers)</span>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a>    <span class="c1"># R[:, labeled_mask] = all m classifiers&#39; predictions on labeled instances</span>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>    <span class="c1"># axis=0 means average across classifiers (m dimension)</span>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a>    <span class="n">baseline_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">R</span><span class="p">[:,</span> <span class="n">labeled_mask</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a>    <span class="k">if</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;prauc&#39;</span><span class="p">:</span>
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a>        <span class="n">baseline_score</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">baseline_pred</span><span class="p">)</span>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a>    <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;roc_auc&#39;</span><span class="p">:</span>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a>        <span class="n">baseline_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">baseline_pred</span><span class="p">)</span>
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a>    <span class="k">elif</span> <span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;f1&#39;</span><span class="p">:</span>
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a>        <span class="n">baseline_pred_binary</span> <span class="o">=</span> <span class="p">(</span><span class="n">baseline_pred</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a>        <span class="n">baseline_score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">baseline_pred_binary</span><span class="p">)</span>
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a>        <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span>
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>        <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a>        <span class="s1">&#39;n_labeled&#39;</span><span class="p">:</span> <span class="n">labeled_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a>        <span class="s1">&#39;positive_rate&#39;</span><span class="p">:</span> <span class="n">pos_rate</span><span class="p">,</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a>        <span class="s1">&#39;is_imbalanced&#39;</span><span class="p">:</span> <span class="n">is_imbalanced</span><span class="p">,</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>        <span class="s1">&#39;metric_used&#39;</span><span class="p">:</span> <span class="n">metric</span><span class="p">,</span>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a>        <span class="s1">&#39;avg_quality&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">qualities</span><span class="p">),</span>
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a>        <span class="s1">&#39;min_quality&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">qualities</span><span class="p">),</span>
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a>        <span class="s1">&#39;max_quality&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">qualities</span><span class="p">),</span>
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a>        <span class="s1">&#39;diversity&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">qualities</span><span class="p">),</span>
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a>        <span class="s1">&#39;qualities&#39;</span><span class="p">:</span> <span class="n">qualities</span><span class="p">,</span>
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a>        <span class="s1">&#39;baseline_score&#39;</span><span class="p">:</span> <span class="n">baseline_score</span>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a>    <span class="p">}</span>
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a><span class="c1"># Example usage</span>
</span><span id="__span-6-95"><a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a><span class="n">config</span> <span class="o">=</span> <span class="n">evaluate_ensemble_config</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">labeled_idx</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</span><span id="__span-6-96"><a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a>
</span><span id="__span-6-97"><a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Ensemble Configuration:&quot;</span><span class="p">)</span>
</span><span id="__span-6-98"><a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Ensemble size: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> classifiers&quot;</span><span class="p">)</span>
</span><span id="__span-6-99"><a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Data: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;n_labeled&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> labeled, positive rate </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;positive_rate&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-100"><a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="s1">&#39;⚠️  Imbalanced!&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;is_imbalanced&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;✓ Balanced&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-101"><a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📈 Quality Metrics (</span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;metric_used&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
</span><span id="__span-6-102"><a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Average quality: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;avg_quality&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-103"><a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Quality range: [</span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;min_quality&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;max_quality&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span id="__span-6-104"><a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Diversity (std): </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;diversity&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-105"><a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🎯 Baseline Performance:&quot;</span><span class="p">)</span>
</span><span id="__span-6-106"><a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Simple averaging: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;baseline_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;metric_used&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-107"><a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">→ This is what we mean by &#39;quality </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;avg_quality&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Output example (Imbalanced data - e.g., splice sites)</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>⚙️  Auto-selected metric: PRAUC (positive rate: 15.0%)
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>📊 Ensemble Configuration:
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>   Ensemble size: 15 classifiers
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>   Data: 200 labeled, positive rate 15.0%
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>   ⚠️  Imbalanced!
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>📈 Quality Metrics (PRAUC):
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>   Average quality: 0.52
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>   Quality range: [0.38, 0.68]
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>   Diversity (std): 0.095
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>🎯 Baseline Performance:
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>   Simple averaging: 0.74 PRAUC
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>→ This is what we mean by &#39;quality 0.52&#39;
</span></code></pre></div></p>
<p><strong>Key insights</strong>: 
1. <strong>Imbalance detected</strong> (15% positives) → Auto-selected PR-AUC
2. <strong>Individual classifiers weak</strong> (avg 0.52 PR-AUC) but <strong>ensemble strong</strong> (0.74 PR-AUC)
3. This is the <strong>ensemble size effect</strong> - even weak classifiers become powerful when averaged!</p>
<p><strong>Output example (Balanced data)</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>⚙️  Auto-selected metric: ROC_AUC (positive rate: 48.0%)
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>📊 Ensemble Configuration:
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>   Ensemble size: 15 classifiers
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>   Data: 200 labeled, positive rate 48.0%
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>   ✓ Balanced
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>📈 Quality Metrics (ROC_AUC):
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>   Average quality: 0.68
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>   Quality range: [0.55, 0.78]
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>   Diversity (std): 0.082
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>🎯 Baseline Performance:
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>   Simple averaging: 0.89 ROC-AUC
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>→ This is what we mean by &#39;quality 0.68&#39;
</span></code></pre></div></p>
<hr />
<h2 id="quick-decision-tree">Quick Decision Tree<a class="headerlink" href="#quick-decision-tree" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Step 1: What&#39;s your minority class rate?
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>├─ 5-10% positives (rare disease, drug response):
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>│   └─ ✅✅✅ OPTIMAL for confidence weighting! (Expected: +1-4%)
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>│       → Proceed to Step 2
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>│
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>├─ 2-5% positives (very rare events):
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>│   └─ ✅ Good candidate (Expected: +0.5-4%, varies)
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>│       → Proceed to Step 2, test on your data
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>│
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>├─ 10-20% positives (moderate imbalance):
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>│   └─ ✅ Can help (Expected: +0.5-2%)
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>│       → Proceed to Step 2
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>│
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>└─ &lt;1% positives (splice sites, extreme rarity):
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>    └─ ❌ Not recommended (Expected: &lt; 0.5%)
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>        → Focus on: More data, better features, active learning
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>Step 2: How many classifiers do you have?
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>├─ m ≥ 15: Simple averaging very effective
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>│   └─ Expected gain from confidence weighting:
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>│       - 5% positives: +2-4% ⭐
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>│       - 10% positives: +0.5-1%
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>│       - Use if every % matters!
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>│
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>├─ 10 ≤ m &lt; 15: Confidence weighting helpful
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>│   └─ Expected gain: +1-5% (depending on imbalance)
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>│       → Especially good at 5% positives
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>│
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>├─ 5 ≤ m &lt; 10: Confidence weighting very helpful
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>│   └─ Expected gain: +2-8%
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>│       → Sweet spot for confidence weighting!
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>│
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a>└─ m &lt; 5: Confidence weighting critical!
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>    └─ Expected gain: +3-10%
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>        Individual classifier quality matters most
</span></code></pre></div>
<hr />
<h2 id="experimental-evidence-2026-01-24">Experimental Evidence (2026-01-24)<a class="headerlink" href="#experimental-evidence-2026-01-24" title="Permanent link">&para;</a></h2>
<h3 id="imbalanced-data-experiments-primary-results">Imbalanced Data Experiments ⭐ <strong>PRIMARY RESULTS</strong><a class="headerlink" href="#imbalanced-data-experiments-primary-results" title="Permanent link">&para;</a></h3>
<p><strong>Setup:</strong>
- 15 classifiers, high diversity
- 3 trials per quality level
- Primary metric: <strong>PR-AUC</strong> (appropriate for imbalanced data)</p>
<p><strong>Three scenarios tested:</strong></p>
<table>
<thead>
<tr>
<th>Imbalance</th>
<th>Random Baseline</th>
<th>Peak Improvement</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>10% positives</strong></td>
<td>0.10</td>
<td><strong>+1.06%</strong></td>
<td>✅ Recommended</td>
</tr>
<tr>
<td><strong>5% positives</strong> ⭐</td>
<td>0.05</td>
<td><strong>+3.94%</strong> 🏆</td>
<td>✅✅✅ <strong>OPTIMAL</strong></td>
</tr>
<tr>
<td><strong>1% positives</strong></td>
<td>0.01</td>
<td><strong>+0.10%</strong></td>
<td>❌ Not recommended</td>
</tr>
</tbody>
</table>
<h3 id="key-discovery-the-5-sweet-spot">Key Discovery: The 5% Sweet Spot<a class="headerlink" href="#key-discovery-the-5-sweet-spot" title="Permanent link">&para;</a></h3>
<p><strong>Most important finding</strong>: <strong>5% positives (95% negatives) shows BEST gains!</strong></p>
<p><strong>Why?</strong>
- <strong>Not too easy</strong> (10% has less room for improvement)
- <strong>Not too hard</strong> (1% hits fundamental limits)
- <strong>Just right</strong> - Challenging but learnable</p>
<p><strong>Results at 5% positives:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Quality 0.158 PR-AUC (Best point):
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>  Baseline: 0.197 PR-AUC
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>  Learned:  0.237 PR-AUC
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>  Gain: +3.94% (+0.040 PR-AUC points)
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>  This is HUGE for rare disease detection!
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>  → 20% relative improvement in catching positives
</span></code></pre></div></p>
<h3 id="results-by-imbalance-level">Results by Imbalance Level<a class="headerlink" href="#results-by-imbalance-level" title="Permanent link">&para;</a></h3>
<p><strong>10% Positives (Disease Detection)</strong>
- Quality range: 0.112 - 0.270 PR-AUC
- Peak improvement: +1.06% at quality 0.270
- Baseline already decent (0.60 PR-AUC) → less room to improve</p>
<p><strong>5% Positives (Rare Disease)</strong> ⭐
- Quality range: 0.050 - 0.158 PR-AUC<br />
- Peak improvement: <strong>+3.94%</strong> at quality 0.158 🏆
- Optimal balance of challenge and learnability</p>
<p><strong>1% Positives (Splice Sites)</strong>
- Quality range: 0.029 - 0.097 PR-AUC
- Peak improvement: +0.10% (negligible)
- Extreme rarity makes improvements very difficult</p>
<p><strong>Visualizations:</strong> 
- Individual results: <code>results/quality_threshold_*/quality_threshold_analysis.png</code>
- Side-by-side comparison: <code>results/imbalance_comparison.png</code></p>
<h3 id="earlier-experiments-balancedmild-imbalance">Earlier Experiments (Balanced/Mild Imbalance)<a class="headerlink" href="#earlier-experiments-balancedmild-imbalance" title="Permanent link">&para;</a></h3>
<p><strong>Setup:</strong>
- 15 classifiers, high diversity
- Quality range: 0.45-0.72 ROC-AUC
- 5 trials per level
- Data: Mild imbalance (60/40) with realistic complexity</p>
<p><strong>⚠️ Note</strong>: These earlier experiments used ROC-AUC. The ensemble size effect and quality patterns hold across metrics, but absolute thresholds differ.</p>
<table>
<thead>
<tr>
<th>Quality (ROC-AUC)</th>
<th>Baseline</th>
<th>Label-Aware</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.45</td>
<td>0.39</td>
<td>0.40</td>
<td><strong>+0.44 pts</strong></td>
</tr>
<tr>
<td>0.48</td>
<td>0.48</td>
<td>0.49</td>
<td><strong>+0.49 pts</strong></td>
</tr>
<tr>
<td>0.50</td>
<td>0.59</td>
<td>0.59</td>
<td><strong>+0.47 pts</strong></td>
</tr>
<tr>
<td>0.54</td>
<td>0.71</td>
<td>0.72</td>
<td><strong>+0.40 pts</strong></td>
</tr>
<tr>
<td>0.58</td>
<td><strong>0.83</strong></td>
<td>0.83</td>
<td>+0.28 pts</td>
</tr>
<tr>
<td>0.61</td>
<td><strong>0.90</strong></td>
<td>0.90</td>
<td>+0.16 pts</td>
</tr>
<tr>
<td>0.65</td>
<td><strong>0.95</strong></td>
<td>0.95</td>
<td>+0.13 pts</td>
</tr>
<tr>
<td>0.70</td>
<td><strong>0.98</strong></td>
<td>0.98</td>
<td>+0.06 pts</td>
</tr>
</tbody>
</table>
<p><strong>Key Finding</strong>: With 15 classifiers at quality 0.58, simple averaging already achieves <strong>0.83 ROC-AUC</strong>! The law of large numbers is powerful.</p>
<hr />
<h2 id="the-ensemble-size-effect">The Ensemble Size Effect<a class="headerlink" href="#the-ensemble-size-effect" title="Permanent link">&para;</a></h2>
<h3 id="why-size-matters">Why Size Matters<a class="headerlink" href="#why-size-matters" title="Permanent link">&para;</a></h3>
<p><strong>Mathematical Intuition:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Individual error: e = 1 - quality (where quality = ROC-AUC)
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>Ensemble error: E ≈ e / √m
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>Example with quality = 0.70 ROC-AUC (e = 0.30):
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  m = 3:  E ≈ 0.30 / √3  ≈ 0.17  → Ensemble ~0.83 ROC-AUC
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  m = 5:  E ≈ 0.30 / √5  ≈ 0.13  → Ensemble ~0.87 ROC-AUC
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>  m = 10: E ≈ 0.30 / √10 ≈ 0.09  → Ensemble ~0.91 ROC-AUC
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>  m = 15: E ≈ 0.30 / √15 ≈ 0.08  → Ensemble ~0.92 ROC-AUC
</span></code></pre></div></p>
<p><strong>Real Results</strong> (from experiments):
- Quality 0.58, m=15 → Baseline 0.83 (very close to theory!)
- Quality 0.70, m=15 → Baseline 0.98</p>
<p><strong>Implication</strong>: With many classifiers, simple averaging is already near-optimal!</p>
<h3 id="when-ensemble-size-doesnt-save-you">When Ensemble Size Doesn't Save You<a class="headerlink" href="#when-ensemble-size-doesnt-save-you" title="Permanent link">&para;</a></h3>
<p>❌ <strong>Systematic biases</strong> - All classifiers fail on same subgroup<br />
❌ <strong>Low diversity</strong> - Classifiers make correlated errors<br />
❌ <strong>Domain-specific expertise</strong> - Some classifiers excel on specific cases<br />
❌ <strong>Severe miscalibration</strong> - Confidence scores meaningless  </p>
<p>In these cases, confidence weighting can help even with m &gt; 12.</p>
<hr />
<h2 id="strategy-recommendations">Strategy Recommendations<a class="headerlink" href="#strategy-recommendations" title="Permanent link">&para;</a></h2>
<h3 id="for-large-ensembles-m-12">For Large Ensembles (m ≥ 12)<a class="headerlink" href="#for-large-ensembles-m-12" title="Permanent link">&para;</a></h3>
<p><strong>Default: Simple Averaging</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">ensemble_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>When to try confidence weighting:</strong>
- Classifiers have known domain expertise (e.g., algorithm A excels on subgroup X)
- Very limited labeled data (n_labeled &lt; 50)
- You observe that some classifiers consistently fail on specific subgroups</p>
<p><strong>Recommended strategy:</strong> <code>LabelAwareConfidence</code> (simple, consistent +0.3-0.5%)</p>
<h3 id="for-medium-ensembles-5-m-12">For Medium Ensembles (5 ≤ m &lt; 12)<a class="headerlink" href="#for-medium-ensembles-5-m-12" title="Permanent link">&para;</a></h3>
<p><strong>⭐ Sweet spot for confidence weighting!</strong></p>
<p><strong>Quality 0.55-0.75 + High Diversity:</strong>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Option 1: Label-aware (simple, robust)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">confidence_strategy</span> <span class="o">=</span> <span class="n">LabelAwareConfidence</span><span class="p">()</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1"># Option 2: Learned reliability (if systematic biases exist)</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">rel_model</span> <span class="o">=</span> <span class="n">ReliabilityWeightModel</span><span class="p">()</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">rel_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">labeled_idx</span><span class="p">,</span> <span class="n">classifier_stats</span><span class="p">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="n">W_learned</span> <span class="o">=</span> <span class="n">rel_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Expected gains:</strong>
- Label-aware: +0.5-1.5% ROC-AUC
- Learned reliability: +0.5-3% (if biases present)</p>
<h3 id="for-small-ensembles-m-5">For Small Ensembles (m &lt; 5)<a class="headerlink" href="#for-small-ensembles-m-5" title="Permanent link">&para;</a></h3>
<p><strong>Confidence weighting is critical!</strong></p>
<p>Individual classifier quality matters significantly. Use:</p>
<ol>
<li><strong>Evaluate each classifier carefully</strong></li>
<li><strong>Learn cell-level reliability</strong></li>
<li><strong>Consider removing weak classifiers</strong> (m=4 strong &gt; m=6 mixed)</li>
</ol>
<p><strong>Expected gains:</strong> 1-5% ROC-AUC improvement</p>
<hr />
<h2 id="class-imbalance-impact-validated-2026-01-24">Class Imbalance Impact (Validated 2026-01-24)<a class="headerlink" href="#class-imbalance-impact-validated-2026-01-24" title="Permanent link">&para;</a></h2>
<h3 id="the-goldilocks-principle-of-imbalance">The Goldilocks Principle of Imbalance<a class="headerlink" href="#the-goldilocks-principle-of-imbalance" title="Permanent link">&para;</a></h3>
<p><strong>Key Finding:</strong> Confidence weighting effectiveness follows a <strong>non-monotonic</strong> relationship with imbalance!</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>Improvement vs Minority Class Rate:
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a> 4% ┤        ╭────╮ ← 5% positives: BEST GAINS!
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    │       ╱      ╲
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a> 2% ┤      ╱        ╲
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    │     ╱          ╲___
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a> 1% ┤____╱               ╰___ 1% positives
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    │   10% pos              
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a> 0% ┼────┬────┬────┬────┬────┬────
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    0%   5%   10%  15%  20%  25%
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>         Minority Class Rate
</span></code></pre></div>
<h3 id="recommendations-by-imbalance-level">Recommendations by Imbalance Level<a class="headerlink" href="#recommendations-by-imbalance-level" title="Permanent link">&para;</a></h3>
<h4 id="5-10-positives-optimal-range">✅✅✅ 5-10% Positives: <strong>OPTIMAL RANGE</strong><a class="headerlink" href="#5-10-positives-optimal-range" title="Permanent link">&para;</a></h4>
<p><strong>Scenarios:</strong> Rare disease (5-10% prevalence), drug response (10-20% responders)</p>
<p><strong>Why optimal:</strong>
- Challenging enough that confidence weighting matters
- Tractable enough to learn meaningful patterns
- Best balance of signal and difficulty</p>
<p><strong>Expected Results (m=15):</strong>
- Quality range: 0.15-0.27 PR-AUC
- Improvements: <strong>+1-4%</strong> PR-AUC
- <strong>5% positives shows peak gains (+3.94%)</strong></p>
<p><strong>Action:</strong> ✅ <strong>Strong recommendation for confidence weighting!</strong></p>
<h4 id="2-5-positives-good-candidate">✅ 2-5% Positives: Good Candidate<a class="headerlink" href="#2-5-positives-good-candidate" title="Permanent link">&para;</a></h4>
<p><strong>Scenarios:</strong> Very rare diseases, uncommon adverse events</p>
<p><strong>Expected Results:</strong>
- Variable gains: +0.5-4% (depends on exact rate)
- Best around 5% (peak of curve)</p>
<p><strong>Action:</strong> ✅ Recommended, test on your data first</p>
<h4 id="10-20-positives-moderate-benefit">⚠️ 10-20% Positives: Moderate Benefit<a class="headerlink" href="#10-20-positives-moderate-benefit" title="Permanent link">&para;</a></h4>
<p><strong>Scenarios:</strong> Moderate imbalance, common diseases</p>
<p><strong>Expected Results:</strong>
- Improvements: +0.5-1.5%
- Baseline already decent due to more positives</p>
<p><strong>Action:</strong> ⚠️ Optional - cost/benefit analysis needed</p>
<h4 id="1-positives-not-recommended">❌ &lt;1% Positives: Not Recommended<a class="headerlink" href="#1-positives-not-recommended" title="Permanent link">&para;</a></h4>
<p><strong>Scenarios:</strong> Splice sites (0.1-1%), extremely rare events</p>
<p><strong>Why not:</strong>
- Fundamental scarcity limits learning
- Confidence weighting: &lt; 0.5% gain
- Ensemble averaging already at limits</p>
<p><strong>Expected Results (at 1% positives):</strong>
- Quality range: 0.03-0.10 PR-AUC
- Improvements: <strong>+0.1%</strong> (negligible)</p>
<p><strong>Action:</strong> Focus on:
1. 🔴 <strong>More labeled data</strong> (especially positives!)
2. 🔴 <strong>Better features</strong> (domain expertise critical)
3. 🔴 <strong>Active learning</strong> (target rare positives)
4. 🔴 <strong>Cost-sensitive methods</strong> (penalize missing positives)
5. 🔴 <strong>Specialized algorithms</strong> (SMOTE, focal loss, etc.)</p>
<p><strong>Then</strong> consider confidence weighting after improvements above.</p>
<hr />
<h2 id="quality-thresholds-validated">Quality Thresholds (Validated)<a class="headerlink" href="#quality-thresholds-validated" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Note</strong>: "Quality" = average of your chosen metric across all classifiers.
- <strong>Imbalanced data</strong>: Use <strong>PR-AUC</strong> or <strong>F1-Score</strong> (recommended)
- <strong>Balanced data</strong>: ROC-AUC is acceptable</p>
<p>The thresholds below were validated with ROC-AUC, but <strong>the patterns hold for other metrics</strong>:
- Sweet spot exists (moderate quality)
- Ceiling effect at high quality
- Below-random performance indicates problems</p>
<p>See <a href="#key-definitions">Key Definitions</a> for how to compute your metric.</p>
</blockquote>
<h3 id="below-055-roc-auc-fix-classifiers-first">❌ Below 0.55 ROC-AUC: Fix Classifiers First<a class="headerlink" href="#below-055-roc-auc-fix-classifiers-first" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Individual quality too low</strong>: Barely better than random (0.50)</li>
<li><strong>Too noisy</strong> for confidence weighting</li>
<li><strong>Expected gain</strong>: &lt; 0.3% ROC-AUC improvement</li>
<li><strong>Action:</strong> Improve base classifiers first</li>
<li>Better features / feature engineering</li>
<li>Hyperparameter tuning</li>
<li>Try different algorithms</li>
<li>Get more training data</li>
</ul>
<h3 id="055-075-roc-auc-optimal-range">✅ 0.55-0.75 ROC-AUC: Optimal Range ⭐<a class="headerlink" href="#055-075-roc-auc-optimal-range" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Reliable enough</strong> for meaningful confidence signals</li>
<li><strong>Significant room</strong> for improvement</li>
<li><strong>Expected gain</strong>: 0.5-2% ROC-AUC (depends on m and diversity)</li>
<li><strong>Action:</strong> <strong>Apply confidence weighting</strong> - This is the sweet spot!</li>
<li>With m &lt; 8: Expect 1-2% gains</li>
<li>With m = 8-12: Expect 0.5-1% gains</li>
<li>With m &gt; 12: Expect 0.3-0.5% gains</li>
</ul>
<h3 id="075-085-roc-auc-diminishing-returns">⚠️ 0.75-0.85 ROC-AUC: Diminishing Returns<a class="headerlink" href="#075-085-roc-auc-diminishing-returns" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Already good</strong> performance</li>
<li><strong>Less room</strong> for improvement</li>
<li><strong>Expected gain</strong>: 0.2-0.8% ROC-AUC</li>
<li><strong>Action:</strong> Optional - test if worth the complexity</li>
<li>May help if systematic biases exist</li>
<li>Consider cost vs. benefit</li>
</ul>
<h3 id="above-085-roc-auc-ceiling-effect">⚠️ Above 0.85 ROC-AUC: Ceiling Effect<a class="headerlink" href="#above-085-roc-auc-ceiling-effect" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Near-optimal</strong> performance</li>
<li><strong>Minimal improvement</strong> possible (approaching theoretical limit)</li>
<li><strong>Expected gain</strong>: &lt; 0.1% ROC-AUC</li>
<li><strong>Action:</strong> <strong>Skip confidence weighting</strong></li>
<li>Simple averaging is sufficient</li>
<li>Focus effort elsewhere (data quality, feature engineering)</li>
</ul>
<hr />
<h2 id="common-misconceptions">Common Misconceptions<a class="headerlink" href="#common-misconceptions" title="Permanent link">&para;</a></h2>
<h3 id="more-classifiers-always-use-confidence-weighting">❌ "More classifiers → Always use confidence weighting"<a class="headerlink" href="#more-classifiers-always-use-confidence-weighting" title="Permanent link">&para;</a></h3>
<p><strong>Reality:</strong> With m ≥ 15, simple averaging is already excellent. Confidence weighting provides minimal gains (&lt;0.3%) unless systematic biases exist.</p>
<h3 id="confidence-weighting-always-helps">❌ "Confidence weighting always helps"<a class="headerlink" href="#confidence-weighting-always-helps" title="Permanent link">&para;</a></h3>
<p><strong>Reality:</strong> It helps most with:
- <strong>Fewer classifiers</strong> (m &lt; 8)
- <strong>Moderate quality</strong> (0.55-0.75)
- <strong>High diversity</strong> (different strengths/weaknesses)
- <strong>Systematic biases</strong> (domain-specific failures)</p>
<h3 id="low-quality-confidence-weighting-can-save-it">❌ "Low quality → Confidence weighting can save it"<a class="headerlink" href="#low-quality-confidence-weighting-can-save-it" title="Permanent link">&para;</a></h3>
<p><strong>Reality:</strong> Below 0.55 ROC-AUC, classifiers are too noisy. Fix them first!</p>
<h3 id="large-ensembles-simple-averaging-powerful">✅ "Large ensembles + simple averaging = powerful"<a class="headerlink" href="#large-ensembles-simple-averaging-powerful" title="Permanent link">&para;</a></h3>
<p><strong>Truth:</strong> The law of large numbers is remarkably effective. With 15 diverse classifiers at 0.70 quality, you already get ~0.98 ROC-AUC from simple averaging!</p>
<hr />
<h2 id="diagnostic-checklist">Diagnostic Checklist<a class="headerlink" href="#diagnostic-checklist" title="Permanent link">&para;</a></h2>
<p>Before implementing confidence weighting (see <a href="#key-definitions">Key Definitions</a> for metric details):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">average_precision_score</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1"># 1. Check ensemble size</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">shape</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ensemble size: </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">:</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Simple averaging likely sufficient&quot;</span><span class="p">)</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c1"># 2. Detect imbalance and choose metric</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="n">y_true_labeled</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">pos_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_true_labeled</span><span class="p">)</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="n">is_imbalanced</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_rate</span> <span class="o">&lt;</span> <span class="mf">0.3</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">pos_rate</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="k">if</span> <span class="n">is_imbalanced</span><span class="p">:</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⚠️  Imbalanced data detected (positive rate: </span><span class="si">{</span><span class="n">pos_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Using PR-AUC as quality metric&quot;</span><span class="p">)</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>    <span class="c1"># Compute PR-AUC for each of the m classifiers</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>    <span class="n">quality_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true_labeled</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">mask</span><span class="p">])</span> 
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>                      <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>  <span class="c1"># u = 0, 1, ..., m-1</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>    <span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;PR-AUC&quot;</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Balanced data (positive rate: </span><span class="si">{</span><span class="n">pos_rate</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Using ROC-AUC as quality metric&quot;</span><span class="p">)</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>    <span class="c1"># Compute ROC-AUC for each of the m classifiers</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>    <span class="n">quality_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true_labeled</span><span class="p">,</span> <span class="n">R</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">mask</span><span class="p">])</span> 
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>                      <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>  <span class="c1"># u = 0, 1, ..., m-1</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>    <span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;ROC-AUC&quot;</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="c1"># 3. Check quality</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="n">avg_quality</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">quality_scores</span><span class="p">)</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average quality (</span><span class="si">{</span><span class="n">metric_name</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">avg_quality</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="k">if</span> <span class="n">avg_quality</span> <span class="o">&lt;</span> <span class="mf">0.55</span><span class="p">:</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Too weak, fix classifiers first&quot;</span><span class="p">)</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a><span class="k">elif</span> <span class="n">avg_quality</span> <span class="o">&gt;</span> <span class="mf">0.85</span><span class="p">:</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Already excellent, minimal gains expected&quot;</span><span class="p">)</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="c1"># 4. Check diversity</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a><span class="n">diversity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">quality_scores</span><span class="p">)</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diversity (std): </span><span class="si">{</span><span class="n">diversity</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="k">if</span> <span class="n">diversity</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;→ Low diversity, increase variety first&quot;</span><span class="p">)</span>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a><span class="c1"># 5. Check baseline ensemble</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a><span class="n">baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a><span class="k">if</span> <span class="n">is_imbalanced</span><span class="p">:</span>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48" href="#__codelineno-15-48"></a>    <span class="n">baseline_score</span> <span class="o">=</span> <span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_true_labeled</span><span class="p">,</span> <span class="n">baseline</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49" href="#__codelineno-15-49"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50" href="#__codelineno-15-50"></a>    <span class="n">baseline_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_true_labeled</span><span class="p">,</span> <span class="n">baseline</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51" href="#__codelineno-15-51"></a>
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52" href="#__codelineno-15-52"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Baseline ensemble </span><span class="si">{</span><span class="n">metric_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">baseline_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53" href="#__codelineno-15-53"></a>
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54" href="#__codelineno-15-54"></a><span class="c1"># Decision</span>
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55" href="#__codelineno-15-55"></a><span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">12</span> <span class="ow">and</span> <span class="n">baseline_score</span> <span class="o">&gt;</span> <span class="mf">0.90</span><span class="p">:</span>
</span><span id="__span-15-56"><a id="__codelineno-15-56" name="__codelineno-15-56" href="#__codelineno-15-56"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Simple averaging already excellent!&quot;</span><span class="p">)</span>
</span><span id="__span-15-57"><a id="__codelineno-15-57" name="__codelineno-15-57" href="#__codelineno-15-57"></a><span class="k">elif</span> <span class="mi">5</span> <span class="o">&lt;=</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="mi">12</span> <span class="ow">and</span> <span class="mf">0.55</span> <span class="o">&lt;=</span> <span class="n">avg_quality</span> <span class="o">&lt;=</span> <span class="mf">0.75</span> <span class="ow">and</span> <span class="n">diversity</span> <span class="o">&gt;</span> <span class="mf">0.08</span><span class="p">:</span>
</span><span id="__span-15-58"><a id="__codelineno-15-58" name="__codelineno-15-58" href="#__codelineno-15-58"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">⭐ OPTIMAL for confidence weighting!&quot;</span><span class="p">)</span>
</span><span id="__span-15-59"><a id="__codelineno-15-59" name="__codelineno-15-59" href="#__codelineno-15-59"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-15-60"><a id="__codelineno-15-60" name="__codelineno-15-60" href="#__codelineno-15-60"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">⚠️  Confidence weighting may have limited benefit&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Example output (Imbalanced biomedical data)</strong>:
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>Ensemble size: 10
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>⚠️  Imbalanced data detected (positive rate: 12.0%)
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>→ Using PR-AUC as quality metric
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>Average quality (PR-AUC): 0.58
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>Diversity (std): 0.095
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>Baseline ensemble PR-AUC: 0.78
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>⭐ OPTIMAL for confidence weighting!
</span></code></pre></div></p>
<hr />
<h2 id="recommended-reading">Recommended Reading<a class="headerlink" href="#recommended-reading" title="Permanent link">&para;</a></h2>
<ol>
<li><strong><code>base_classifier_quality_analysis.md</code></strong> - Full mathematical and experimental analysis</li>
<li><strong><code>polarity_models_tutorial.md</code></strong> - How to learn cell-level reliability</li>
<li><strong><code>theory_vs_empirics.md</code></strong> - What can be proven vs. what requires experiments</li>
</ol>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p><strong>The Golden Rule:</strong></p>
<blockquote>
<p><em>Confidence weighting is most effective with <strong>few, diverse, moderately-performing classifiers</strong>. With many classifiers, simple averaging is surprisingly powerful!</em></p>
</blockquote>
<p><strong>Practical Threshold:</strong>
- <strong>m &lt; 8:</strong> Consider confidence weighting (expected +0.5-2%)
- <strong>m ≥ 12:</strong> Simple averaging preferred (expected +0.1-0.5%)</p>
<p><strong>Quality Sweet Spot:</strong>
- <strong>0.55-0.75 ROC-AUC</strong> → Maximum gains</p>
<p><strong>Don't Forget:</strong>
- <strong>Diversity matters!</strong> High diversity amplifies gains
- <strong>Check for systematic biases</strong> - They justify confidence weighting even with large ensembles
- <strong>Label scarcity</strong> - Confidence weighting helps more when n_labeled &lt;&lt; n</p>
<hr />
<p><strong>Last Updated:</strong> 2026-01-24<br />
<strong>Based on:</strong> Quality threshold experiments with 15 classifiers, 5 trials, quality range 0.45-0.72</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 CF-Ensemble Research Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/pleiadian53/cf-ensemble" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>